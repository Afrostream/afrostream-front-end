{"version":3,"sources":["../../../server/app/middlewares/middleware-cachehandler.js"],"names":[],"mappings":";;;;;;kBAAe,UAAU,OAAV,EAAmB;AAChC,SAAO,SAAS,YAAT,CAAuB,GAAvB,EAA4B,GAA5B,EAAiC,IAAjC,EAAuC;AAC5C,QAAI,OAAJ,GAAc,YAAY;;;;;;;AAOxB,UAAI,GAAJ,CAAQ,eAAR,EAAyB,SAAzB;AACD,KARD;AASA,QAAI,SAAJ,GAAgB,YAAY;AAC1B,UAAI,GAAJ,CAAQ,eAAR,EAAyB,mBAAzB;AACD,KAFD;AAGA,QAAI,KAAJ,GAAY,UAAU,QAAV,EAAoB;AAC9B,UAAI,GAAJ,CAAQ,eAAR,EAAyB,sBAAsB,YAAY,EAAlC,IAAwC,6BAAjE;AACD,KAFD;AAGA,QAAI,QAAJ,GAAe,YAAY;AACzB,UAAI,GAAJ,CAAQ,eAAR,EAAyB,0BAAzB;AACD,KAFD;AAGA;AACD,GApBD;AAqBD,C","file":"middleware-cachehandler.js","sourcesContent":["export default function (options) {\n  return function cacheHandler (req, res, next) {\n    res.noCache = function () {\n      // default no-cache header should be :\n      // res.set('Cache-Control', 'no-cache, no-store, must-revalidate')\n      // res.set('Pragma', 'no-cache') // http 1.0\n      // res.set('Expires', '0') // proxy\n      // but we have a bug with fastly, we follow the documentation :\n      //  https://docs.fastly.com/guides/tutorials/cache-control-tutorial\n      res.set('Cache-Control', 'private')\n    }\n    res.isDynamic = function () {\n      res.set('Cache-Control', 'public, max-age=0')\n    }\n    res.cache = function (duration) {\n      res.set('Cache-Control', 'public, max-age=' + (duration || 60) + ', stale-while-revalidate=10')\n    }\n    res.isStatic = function () {\n      res.set('Cache-Control', 'public, max-age=31536000')\n    }\n    next()\n  }\n}\n"]}