{"version":3,"sources":["../../server/app/app.js"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AACA,IAAM,MAAM,wBAAZ;;;;;AAKA,IAAM,aAAa,eAAK,OAAL,CAAa,SAAb,EAAwB,eAAxB,CAAnB;AACA,IAAM,YAAY,eAAK,OAAL,CAAa,QAAQ,GAAR,EAAb,EAA4B,MAA5B,CAAlB;;AAEA,SAAS,YAAT,CAAuB,GAAvB,EAA4B,GAA5B,EAAiC,GAAjC,EAAsC,IAAtC,EAA4C;AAC1C,MAAI,MAAJ,CAAW,GAAX;AACA,MAAI,MAAJ,CAAW,OAAX,EAAoB,EAAC,OAAO,GAAR,EAApB;AACD;;;AAGD,IAAM,aAAa,sBAAnB;;AAEA,IAAI,GAAJ,CAAQ,4BAAR;;AAEA,IAAI,GAAJ,CAAQ,uCAAR;;AAEA,IAAI,GAAJ,CAAQ,SAAR,EAAmB,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AAC3C,MAAI,QAAJ;AACA;AACD,CAHD;AAIA,IAAI,GAAJ,CAAQ,kBAAQ,MAAR,CAAe,UAAf,CAAR;AACA,IAAI,GAAJ,CAAQ,SAAR,EAAmB,kBAAQ,MAAR,CAAe,SAAf,CAAnB;AACA,IAAI,GAAJ,CAAQ,SAAR,EAAmB,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;;AAE3C,MAAI,IAAI,GAAJ,CAAQ,KAAR,CAAc,UAAd,CAAJ,EAA+B;AAC7B,QAAI,QAAJ,CAAa,IAAI,GAAJ,CAAQ,OAAR,CAAgB,UAAhB,EAA4B,SAA5B,CAAb;AACD;AACD;AACD,CAND;AAOA,IAAI,GAAJ,CAAQ,4BAAQ,eAAK,IAAL,CAAU,UAAV,EAAsB,aAAtB,CAAR,CAAR;AACA,IAAI,GAAJ,CAAQ,qBAAW,UAAX,CAAsB,EAAC,UAAU,KAAX,EAAtB,CAAR;AACA,IAAI,GAAJ,CAAQ,qBAAW,IAAX,EAAR;AACA,IAAI,GAAJ,CAAQ,6BAAR;AACA,IAAI,GAAJ,CAAQ,2CAAR;AACA,IAAI,GAAJ,CAAQ,YAAR;;;;;AAKA,qBAAW,cAAX,CAA0B,gBAA1B,2BAA8C,IAA9C;AACA,qBAAW,cAAX,CAA0B,MAA1B,EAAkC,UAAU,OAAV,EAAmB;AACnD,SAAO,yBAAe,OAAf,CAAP;AACD,CAFD;;AAIA,IAAI,MAAJ,CAAW,KAAX,EAAkB,kCAAlB;AACA,IAAI,GAAJ,CAAQ,aAAR,EAAuB,KAAvB;AACA,IAAI,GAAJ,CAAQ,MAAR,EAAgB,KAAhB;AACA,IAAI,GAAJ,CAAQ,cAAR,EAAwB,KAAxB;;;AAGA,sBAAO,GAAP,EAAY,SAAZ;;kBAEe,G","file":"app.js","sourcesContent":["import path from 'path'\nimport expressHandlebars from 'express-handlebars'\nimport handlebars from 'handlebars'\nimport routes from './routes'\nimport express from 'express'\nimport favicon from 'serve-favicon'\nimport compression from 'compression'\nimport bodyParser from 'body-parser'\nimport cookieParser from 'cookie-parser'\nimport allowOrigin from './middlewares/middleware-allowcrossdomain'\nimport cacheHandler from './middlewares/middleware-cachehandler'\nconst app = express()\n\n// Serve static files\n// --------------------------------------------------\n\nconst staticPath = path.resolve(__dirname, '../../static/')\nconst buildPath = path.resolve(process.cwd(), 'dist')\n\nfunction errorHandler (err, req, res, next) {\n  res.status(500)\n  res.render('error', {error: err})\n}\n\n//Get hashed path webpack\nconst HASH_REGXP = /\\.([a-f0-9]{32})\\.js/\n// We point to our static assets\napp.use(compression())\n//\napp.use(cacheHandler())\n\napp.use('/static', function (req, res, next) {\n  res.isStatic()\n  next()\n})\napp.use(express.static(staticPath))\napp.use('/static', express.static(buildPath))\napp.use('/static', function (req, res, next) {\n  // faire une regexp sur req.url\n  if (req.url.match(HASH_REGXP)) {\n    res.sendFile(req.url.replace(HASH_REGXP, hashValue))\n  }\n  next()\n})\napp.use(favicon(path.join(staticPath, 'favicon.ico')))\napp.use(bodyParser.urlencoded({extended: false}))\napp.use(bodyParser.json())\napp.use(cookieParser())\napp.use(allowOrigin())\napp.use(errorHandler)\n\n// View engine\n// --------------------------------------------------\n\nhandlebars.registerHelper('json-stringify', ::JSON.stringify)\nhandlebars.registerHelper('json', function (context) {\n  return JSON.stringify(context)\n})\n\napp.engine('hbs', expressHandlebars())\napp.set('view engine', 'hbs')\napp.set('etag', false)\napp.set('x-powered-by', false)\n\n//ROUTES\nroutes(app, buildPath)\n\nexport default app\n"]}